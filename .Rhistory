group_by(ChEBIid,ChEMBLid) %>%
summarise(ChEBIrole = paste(ChEBIrole, collapse = "; "),
ChEBIrolename = paste(ChEBIrolename, collapse = "; "))
chembl_chebi <- chembl_chebi %>%
mutate_all(~str_replace_all(.,"NA",""))
#Replacing literal 'NA' with empty string
chembl_map <- read.delim(paste0(getwd(),"/Data/chembl_name.tsv"),sep="\t")
#Loading a file containing ChEMBL IDs mapped to compound names retrieved through the WikiData SPARQL endpoint
chembl_chebi <- merge(chembl_chebi, chembl_map, by = "ChEMBLid",all=TRUE)
#Adding compound names to the df
chembl_chebi$type <- "ChEBI node"
chembl_chebi$label <- chembl_chebi$compound_name
#Adding type and label attributes for visualisation
loadTableData(chembl_chebi, data.key.column = "ChEMBLid", "node",table.key.column = "CTL.ChEMBL")
#loading data back to network
chebi_node <- getTableColumns("node",c("SUID","CTL.ChEMBL","ChEBIid"))
#Getting SUID, ChEMBL, and ChEBI columns of all nodes to filter
chemblnochebi <- chebi_node %>%
filter(!is.na(CTL.ChEMBL) & is.na(ChEBIid))
#Filtering for nodes that have a ChEMBL ID but no ChEBI ID
#Desired to remove all CTL-added nodes that couldn't be mapped to a ChEBI ID
selectNodes(nodes = chemblnochebi$SUID, by.col = "SUID")
#Selecting these nodes in Cytoscape
deleteSelectedNodes()
#Deleting selected nodes
#This process could also be done by using Cytoscape filters (createcolumnFilter), but is much slower
#Removing ChEMBL nodes added by CyTargetLinker that do not have ChEBI IDs
deleteTableColumn("CTL.ChEMBL")
renameNetwork("gene-KE-AOP network with pathways and chemicals")
exportNetwork(filename=paste0(nw_savepath,"gene-AOP merged network with pathways and chemicals"), type="CX", overwriteFile = TRUE)
end_section("ChEBI extension")
## ChEBI ROLE SUBSETTING --------------------------------------------------------------------------------------------------------------------------------
start_section("ChEBI role subsetting")
rolecount <- chembl_chebi$ChEBIrolename %>%
strsplit("; ") %>%
unlist() %>%
data.frame(role = .) %>%
group_by(role) %>%
summarize(count = n()) %>%
arrange(desc(count))
#Counting how frequently which ChEBI roles can be mapped to a chemical in the network
#Can be used to select roles of interest based on frequency\
#write.table(rolecount, "C:/users/klemm/Desktop/rolecount-all.tsv",sep="\t",quote=FALSE,row.names=FALSE)
filter_chebi <- function(keyword) {
chems <- chembl_chebi %>%
separate_rows(ChEBIrolename, sep = "; ") %>%
filter(grepl(keyword,ChEBIrolename)) %>%
pull(ChEBIid) %>%
as.list() %>%
selectNodes( ,by.col="ChEBIid")
chems_list <- chems$nodes
#Defining a simple function to filter ChEBI nodes by associated role name
#Getting nodes matching the given ChEBI role
chems_genes <- selectFirstNeighbors(direction="outgoing")
#Getting first neighbors of ChEBI nodes, which will be gene nodes
clearSelection()
genes <- setdiff(chems_genes$nodes, chems$nodes)
#Getting the SUIDs of the gene nodes associated with a given ChEBI role
#Done by getting the intersection between ChEBI nodes and the selection of both ChEBI and gene nodes
#This is because gene nodes are selected as being first neighbors, so the set of selected nodes will contain both the ChEBI and gene nodes
selectNodes(genes)
#Selecting gene nodes associated with given ChEBI role
genes_pws <- selectFirstNeighbors(direction="outgoing")
#Getting outgoing first neighbors of gene nodes which are pathway and cluster nodes
pws <- setdiff(genes_pws$nodes,genes)
#Again getting the intersection of gene and pathway/cluster nodes due to neighbor selection including both the source and neighbor nodes
clearSelection()
selectNodes(genes)
allngbrs <- selectFirstNeighbors(direction="incoming")
#Selecting incoming first neighbors of gene nodes
#This will select all chemical nodes rather than the chemical nodes with the relevant ChEBI role
suidtype <- getTableColumns("node",columns=c("SUID","type"))
kengbrs <- setdiff(allngbrs$nodes, suidtype[suidtype$type == "ChEBI node","SUID"])
#Therefore, KE nodes are filtered out using the 'type' attribute
kengbrs <- setdiff(kengbrs, genes)
#Filtering out gene nodes
clearSelection()
selectNodes(kengbrs)
aop_kes <- selectFirstNeighbors(direction="incoming")
#Selecting AOP nodes related to KE nodes
aopngbrs <- setdiff(aop_kes$nodes, kengbrs)
#Filtering out KE nodes
clearSelection()
selectNodes(aopngbrs)
aop_aos <- selectFirstNeighbors(direction="incoming")
#Selecting AO nodes related to AOP nodes
aongbrs <- setdiff(aop_aos$nodes, aopngbrs)
clearSelection()
connectednodes <- c(chems_list, genes, pws, kengbrs,aopngbrs, aongbrs)
selectNodes(connectednodes)
createSubnetwork(nodes = connectednodes,subnetwork.name=paste0("Role ", keyword, " subnetwork "))
Sys.sleep(0.5)
setCurrentNetwork("gene-KE-AOP network with pathways and chemicals")
setCurrentView("gene-KE-AOP network with pathways and chemicals")
clearSelection()
}
filter_chebi("environmental contaminant")
filter_chebi("xenobiotic")
filter_chebi("neurotoxin")
filter_chebi("herbicide")
filter_chebi("toxin")
end_section("ChEBI role subsetting")
View(topterms_df)
sessionInfo()
?RCy3
View(rolecount)
createVisualStyle("AOP_vis")
setVisualStyle("AOP_vis")
#Creating and setting a new visual style for the AOP network
setNodeLabelMapping(
table.column="label",
style.name="AOP_vis"
)
#Setting node labels using dedicated node label column
setNodeColorMapping(
table.column = "type",
mapping.type="d",
table.column.values = c("AO","AOP","KE","gene","Pathway","Cluster","ChEBI node"),
colors=c("#FB6a4A","#FEB24C","#FA9FB5","#74C476","#1DEFF2","#1D91C0","#bd34eb"),
style.name="AOP_vis"
)
#Setting node colors using dedicated type column
createColumnFilter(
filter.name = "KE-MIE",
column = "KEisMIEin",
criterion = "h",
predicate = "CONTAINS",
anyMatch = TRUE,
apply = TRUE
)
#Selecting which KEs are tagged as MIEs
kemienode <- getSelectedNodes()
setNodeBorderColorBypass(
node.names = kemienode,
new.colors = "#3030f0"
)
setNodeBorderWidthBypass(
node.names = kemienode,
new.sizes = 20
)
setNodeShapeDefault(
new.shape="ROUND_RECTANGLE",
style.name="AOP_vis"
)
setNodeFontSizeDefault (
new.size = "25",
style.name = "AOP_vis"
)
setEdgeSourceArrowShapeDefault(
new.shape = "DELTA",
style.name="AOP_vis"
)
setEdgeColorDefault(
new.color="#BCBCBC",
style.name="AOP_vis"
)
setEdgeColorMapping(
table.column = "isMIEedge",
table.column.values = c(0,1),
colors = c("#BCBCBC", "#3030f0"),
style.name= "AOP_vis"
)
setEdgeLineWidthMapping(
table.column = "isMIEedge",
table.column.values = c(0,1),
widths = c(1,3),
style.name = "AOP_vis"
)
commandsRun('analyzer analyze directed=true selectedOnly=false')
#Running analyzer for topoligcal information
setNodeSizeMapping(
table.column = "Indegree",
sizes=c(50,250),
mapping.type='c',
style.name="AOP_vis"
)
#Setting node size relative to indegree (in this graph: edges going from bottom to top)
fitContent()
filter_chebi("neurotoxin")
filter_chebi("herbicide")
filter_chebi("herbicide")
filter_chebi("toxin")
?grepl
filter_chebi <- function(keyword) {
chems <- chembl_chebi %>%
separate_rows(ChEBIrolename, sep = "; ") %>%
filter(grepl(paste0("\\b",keyword,"\\b"),ChEBIrolename)) %>%
pull(ChEBIid) %>%
as.list() %>%
selectNodes( ,by.col="ChEBIid")
chems_list <- chems$nodes
#Defining a simple function to filter ChEBI nodes by associated role name
#Getting nodes matching the given ChEBI role
chems_genes <- selectFirstNeighbors(direction="outgoing")
#Getting first neighbors of ChEBI nodes, which will be gene nodes
clearSelection()
genes <- setdiff(chems_genes$nodes, chems$nodes)
#Getting the SUIDs of the gene nodes associated with a given ChEBI role
#Done by getting the intersection between ChEBI nodes and the selection of both ChEBI and gene nodes
#This is because gene nodes are selected as being first neighbors, so the set of selected nodes will contain both the ChEBI and gene nodes
selectNodes(genes)
#Selecting gene nodes associated with given ChEBI role
genes_pws <- selectFirstNeighbors(direction="outgoing")
#Getting outgoing first neighbors of gene nodes which are pathway and cluster nodes
pws <- setdiff(genes_pws$nodes,genes)
#Again getting the intersection of gene and pathway/cluster nodes due to neighbor selection including both the source and neighbor nodes
clearSelection()
selectNodes(genes)
allngbrs <- selectFirstNeighbors(direction="incoming")
#Selecting incoming first neighbors of gene nodes
#This will select all chemical nodes rather than the chemical nodes with the relevant ChEBI role
suidtype <- getTableColumns("node",columns=c("SUID","type"))
kengbrs <- setdiff(allngbrs$nodes, suidtype[suidtype$type == "ChEBI node","SUID"])
#Therefore, KE nodes are filtered out using the 'type' attribute
kengbrs <- setdiff(kengbrs, genes)
#Filtering out gene nodes
clearSelection()
selectNodes(kengbrs)
aop_kes <- selectFirstNeighbors(direction="incoming")
#Selecting AOP nodes related to KE nodes
aopngbrs <- setdiff(aop_kes$nodes, kengbrs)
#Filtering out KE nodes
clearSelection()
selectNodes(aopngbrs)
aop_aos <- selectFirstNeighbors(direction="incoming")
#Selecting AO nodes related to AOP nodes
aongbrs <- setdiff(aop_aos$nodes, aopngbrs)
clearSelection()
connectednodes <- c(chems_list, genes, pws, kengbrs,aopngbrs, aongbrs)
selectNodes(connectednodes)
createSubnetwork(nodes = connectednodes,subnetwork.name=paste0("Role ", keyword, " subnetwork "))
Sys.sleep(0.5)
setCurrentNetwork("gene-KE-AOP network with pathways and chemicals")
setCurrentView("gene-KE-AOP network with pathways and chemicals")
clearSelection()
}
filter_chebi("toxin")
filter_chebi <- function(keyword) {
chems <- chembl_chebi %>%
separate_rows(ChEBIrolename, sep = "; ") %>%
filter(grepl(paste0("\\b(", paste(keywords, collapse = "|"), ")\\b"),ChEBIrolename)) %>%
pull(ChEBIid) %>%
as.list() %>%
selectNodes( ,by.col="ChEBIid")
chems_list <- chems$nodes
#Defining a simple function to filter ChEBI nodes by associated role name
#Getting nodes matching the given ChEBI role
chems_genes <- selectFirstNeighbors(direction="outgoing")
#Getting first neighbors of ChEBI nodes, which will be gene nodes
clearSelection()
genes <- setdiff(chems_genes$nodes, chems$nodes)
#Getting the SUIDs of the gene nodes associated with a given ChEBI role
#Done by getting the intersection between ChEBI nodes and the selection of both ChEBI and gene nodes
#This is because gene nodes are selected as being first neighbors, so the set of selected nodes will contain both the ChEBI and gene nodes
selectNodes(genes)
#Selecting gene nodes associated with given ChEBI role
genes_pws <- selectFirstNeighbors(direction="outgoing")
#Getting outgoing first neighbors of gene nodes which are pathway and cluster nodes
pws <- setdiff(genes_pws$nodes,genes)
#Again getting the intersection of gene and pathway/cluster nodes due to neighbor selection including both the source and neighbor nodes
clearSelection()
selectNodes(genes)
allngbrs <- selectFirstNeighbors(direction="incoming")
#Selecting incoming first neighbors of gene nodes
#This will select all chemical nodes rather than the chemical nodes with the relevant ChEBI role
suidtype <- getTableColumns("node",columns=c("SUID","type"))
kengbrs <- setdiff(allngbrs$nodes, suidtype[suidtype$type == "ChEBI node","SUID"])
#Therefore, KE nodes are filtered out using the 'type' attribute
kengbrs <- setdiff(kengbrs, genes)
#Filtering out gene nodes
clearSelection()
selectNodes(kengbrs)
aop_kes <- selectFirstNeighbors(direction="incoming")
#Selecting AOP nodes related to KE nodes
aopngbrs <- setdiff(aop_kes$nodes, kengbrs)
#Filtering out KE nodes
clearSelection()
selectNodes(aopngbrs)
aop_aos <- selectFirstNeighbors(direction="incoming")
#Selecting AO nodes related to AOP nodes
aongbrs <- setdiff(aop_aos$nodes, aopngbrs)
clearSelection()
connectednodes <- c(chems_list, genes, pws, kengbrs,aopngbrs, aongbrs)
selectNodes(connectednodes)
createSubnetwork(nodes = connectednodes,subnetwork.name=paste0("Role ", keyword, " subnetwork "))
Sys.sleep(0.5)
setCurrentNetwork("gene-KE-AOP network with pathways and chemicals")
setCurrentView("gene-KE-AOP network with pathways and chemicals")
clearSelection()
}
filter_chebi(c("toxin","neurotoxin"))
filter_chebi <- function(keyword) {
chems <- chembl_chebi %>%
separate_rows(ChEBIrolename, sep = "; ") %>%
filter(grepl(paste0("\\b(", paste(keyword, collapse = "|"), ")\\b"),ChEBIrolename)) %>%
pull(ChEBIid) %>%
as.list() %>%
selectNodes( ,by.col="ChEBIid")
chems_list <- chems$nodes
#Defining a simple function to filter ChEBI nodes by associated role name
#Getting nodes matching the given ChEBI role
chems_genes <- selectFirstNeighbors(direction="outgoing")
#Getting first neighbors of ChEBI nodes, which will be gene nodes
clearSelection()
genes <- setdiff(chems_genes$nodes, chems$nodes)
#Getting the SUIDs of the gene nodes associated with a given ChEBI role
#Done by getting the intersection between ChEBI nodes and the selection of both ChEBI and gene nodes
#This is because gene nodes are selected as being first neighbors, so the set of selected nodes will contain both the ChEBI and gene nodes
selectNodes(genes)
#Selecting gene nodes associated with given ChEBI role
genes_pws <- selectFirstNeighbors(direction="outgoing")
#Getting outgoing first neighbors of gene nodes which are pathway and cluster nodes
pws <- setdiff(genes_pws$nodes,genes)
#Again getting the intersection of gene and pathway/cluster nodes due to neighbor selection including both the source and neighbor nodes
clearSelection()
selectNodes(genes)
allngbrs <- selectFirstNeighbors(direction="incoming")
#Selecting incoming first neighbors of gene nodes
#This will select all chemical nodes rather than the chemical nodes with the relevant ChEBI role
suidtype <- getTableColumns("node",columns=c("SUID","type"))
kengbrs <- setdiff(allngbrs$nodes, suidtype[suidtype$type == "ChEBI node","SUID"])
#Therefore, KE nodes are filtered out using the 'type' attribute
kengbrs <- setdiff(kengbrs, genes)
#Filtering out gene nodes
clearSelection()
selectNodes(kengbrs)
aop_kes <- selectFirstNeighbors(direction="incoming")
#Selecting AOP nodes related to KE nodes
aopngbrs <- setdiff(aop_kes$nodes, kengbrs)
#Filtering out KE nodes
clearSelection()
selectNodes(aopngbrs)
aop_aos <- selectFirstNeighbors(direction="incoming")
#Selecting AO nodes related to AOP nodes
aongbrs <- setdiff(aop_aos$nodes, aopngbrs)
clearSelection()
connectednodes <- c(chems_list, genes, pws, kengbrs,aopngbrs, aongbrs)
selectNodes(connectednodes)
createSubnetwork(nodes = connectednodes,subnetwork.name=paste0("Role ", keyword, " subnetwork "))
Sys.sleep(0.5)
setCurrentNetwork("gene-KE-AOP network with pathways and chemicals")
setCurrentView("gene-KE-AOP network with pathways and chemicals")
clearSelection()
}
filter_chebi(c("toxin","neurotoxin"))
filter_chebi <- function(keyword) {
chems <- chembl_chebi %>%
separate_rows(ChEBIrolename, sep = "; ") %>%
filter(grepl(paste0("\\b(", paste(keyword, collapse = "|"), ")\\b"),ChEBIrolename)) %>%
pull(ChEBIid) %>%
as.list() %>%
selectNodes( ,by.col="ChEBIid")
chems_list <- chems$nodes
#Defining a simple function to filter ChEBI nodes by associated role name
#Getting nodes matching the given ChEBI role
chems_genes <- selectFirstNeighbors(direction="outgoing")
#Getting first neighbors of ChEBI nodes, which will be gene nodes
clearSelection()
genes <- setdiff(chems_genes$nodes, chems$nodes)
#Getting the SUIDs of the gene nodes associated with a given ChEBI role
#Done by getting the intersection between ChEBI nodes and the selection of both ChEBI and gene nodes
#This is because gene nodes are selected as being first neighbors, so the set of selected nodes will contain both the ChEBI and gene nodes
selectNodes(genes)
#Selecting gene nodes associated with given ChEBI role
genes_pws <- selectFirstNeighbors(direction="outgoing")
#Getting outgoing first neighbors of gene nodes which are pathway and cluster nodes
pws <- setdiff(genes_pws$nodes,genes)
#Again getting the intersection of gene and pathway/cluster nodes due to neighbor selection including both the source and neighbor nodes
clearSelection()
selectNodes(genes)
allngbrs <- selectFirstNeighbors(direction="incoming")
#Selecting incoming first neighbors of gene nodes
#This will select all chemical nodes rather than the chemical nodes with the relevant ChEBI role
suidtype <- getTableColumns("node",columns=c("SUID","type"))
kengbrs <- setdiff(allngbrs$nodes, suidtype[suidtype$type == "ChEBI node","SUID"])
#Therefore, KE nodes are filtered out using the 'type' attribute
kengbrs <- setdiff(kengbrs, genes)
#Filtering out gene nodes
clearSelection()
selectNodes(kengbrs)
aop_kes <- selectFirstNeighbors(direction="incoming")
#Selecting AOP nodes related to KE nodes
aopngbrs <- setdiff(aop_kes$nodes, kengbrs)
#Filtering out KE nodes
clearSelection()
selectNodes(aopngbrs)
aop_aos <- selectFirstNeighbors(direction="incoming")
#Selecting AO nodes related to AOP nodes
aongbrs <- setdiff(aop_aos$nodes, aopngbrs)
clearSelection()
connectednodes <- c(chems_list, genes, pws, kengbrs,aopngbrs, aongbrs)
selectNodes(connectednodes)
createSubnetwork(nodes = connectednodes,subnetwork.name=paste0(keyword, " subnetwork "))
Sys.sleep(0.5)
setCurrentNetwork("gene-KE-AOP network with pathways and chemicals")
setCurrentView("gene-KE-AOP network with pathways and chemicals")
clearSelection()
}
filter_chebi(c("toxin","neurotoxin"))
filter_chebi("toxin")
filter_chebi <- function(keyword) {
chems <- chembl_chebi %>%
separate_rows(ChEBIrolename, sep = "; ") %>%
filter(grepl(paste0("\\b",keyword,"\\b"),ChEBIrolename)) %>%
pull(ChEBIid) %>%
as.list() %>%
selectNodes( ,by.col="ChEBIid")
chems_list <- chems$nodes
#Defining a simple function to filter ChEBI nodes by associated role name
#Getting nodes matching the given ChEBI role
chems_genes <- selectFirstNeighbors(direction="outgoing")
#Getting first neighbors of ChEBI nodes, which will be gene nodes
clearSelection()
genes <- setdiff(chems_genes$nodes, chems$nodes)
#Getting the SUIDs of the gene nodes associated with a given ChEBI role
#Done by getting the intersection between ChEBI nodes and the selection of both ChEBI and gene nodes
#This is because gene nodes are selected as being first neighbors, so the set of selected nodes will contain both the ChEBI and gene nodes
selectNodes(genes)
#Selecting gene nodes associated with given ChEBI role
genes_pws <- selectFirstNeighbors(direction="outgoing")
#Getting outgoing first neighbors of gene nodes which are pathway and cluster nodes
pws <- setdiff(genes_pws$nodes,genes)
#Again getting the intersection of gene and pathway/cluster nodes due to neighbor selection including both the source and neighbor nodes
clearSelection()
selectNodes(genes)
allngbrs <- selectFirstNeighbors(direction="incoming")
#Selecting incoming first neighbors of gene nodes
#This will select all chemical nodes rather than the chemical nodes with the relevant ChEBI role
suidtype <- getTableColumns("node",columns=c("SUID","type"))
kengbrs <- setdiff(allngbrs$nodes, suidtype[suidtype$type == "ChEBI node","SUID"])
#Therefore, KE nodes are filtered out using the 'type' attribute
kengbrs <- setdiff(kengbrs, genes)
#Filtering out gene nodes
clearSelection()
selectNodes(kengbrs)
aop_kes <- selectFirstNeighbors(direction="incoming")
#Selecting AOP nodes related to KE nodes
aopngbrs <- setdiff(aop_kes$nodes, kengbrs)
#Filtering out KE nodes
clearSelection()
selectNodes(aopngbrs)
aop_aos <- selectFirstNeighbors(direction="incoming")
#Selecting AO nodes related to AOP nodes
aongbrs <- setdiff(aop_aos$nodes, aopngbrs)
clearSelection()
connectednodes <- c(chems_list, genes, pws, kengbrs,aopngbrs, aongbrs)
selectNodes(connectednodes)
createSubnetwork(nodes = connectednodes,subnetwork.name=paste0("Role ", keyword, " subnetwork "))
Sys.sleep(0.5)
setCurrentNetwork("gene-KE-AOP network with pathways and chemicals")
setCurrentView("gene-KE-AOP network with pathways and chemicals")
clearSelection()
}
filter_chebi("toxin")
filter_chebi <- function(keyword) {
chems <- chembl_chebi %>%
separate_rows(ChEBIrolename, sep = "; ") %>%
filter(grepl(paste0("\\b(", paste(keyword, collapse = "|"), ")\\b"),ChEBIrolename)) %>%
pull(ChEBIid) %>%
as.list() %>%
selectNodes( ,by.col="ChEBIid")
chems_list <- chems$nodes
#Defining a simple function to filter ChEBI nodes by associated role name
#Getting nodes matching the given ChEBI role
chems_genes <- selectFirstNeighbors(direction="outgoing")
#Getting first neighbors of ChEBI nodes, which will be gene nodes
clearSelection()
genes <- setdiff(chems_genes$nodes, chems$nodes)
#Getting the SUIDs of the gene nodes associated with a given ChEBI role
#Done by getting the intersection between ChEBI nodes and the selection of both ChEBI and gene nodes
#This is because gene nodes are selected as being first neighbors, so the set of selected nodes will contain both the ChEBI and gene nodes
selectNodes(genes)
#Selecting gene nodes associated with given ChEBI role
genes_pws <- selectFirstNeighbors(direction="outgoing")
#Getting outgoing first neighbors of gene nodes which are pathway and cluster nodes
pws <- setdiff(genes_pws$nodes,genes)
#Again getting the intersection of gene and pathway/cluster nodes due to neighbor selection including both the source and neighbor nodes
clearSelection()
selectNodes(genes)
allngbrs <- selectFirstNeighbors(direction="incoming")
#Selecting incoming first neighbors of gene nodes
#This will select all chemical nodes rather than the chemical nodes with the relevant ChEBI role
suidtype <- getTableColumns("node",columns=c("SUID","type"))
kengbrs <- setdiff(allngbrs$nodes, suidtype[suidtype$type == "ChEBI node","SUID"])
#Therefore, KE nodes are filtered out using the 'type' attribute
kengbrs <- setdiff(kengbrs, genes)
#Filtering out gene nodes
clearSelection()
selectNodes(kengbrs)
aop_kes <- selectFirstNeighbors(direction="incoming")
#Selecting AOP nodes related to KE nodes
aopngbrs <- setdiff(aop_kes$nodes, kengbrs)
#Filtering out KE nodes
clearSelection()
selectNodes(aopngbrs)
aop_aos <- selectFirstNeighbors(direction="incoming")
#Selecting AO nodes related to AOP nodes
aongbrs <- setdiff(aop_aos$nodes, aopngbrs)
clearSelection()
connectednodes <- c(chems_list, genes, pws, kengbrs,aopngbrs, aongbrs)
selectNodes(connectednodes)
createSubnetwork(nodes = connectednodes, subnetwork.name = paste0("Role ", paste(keyword, collapse = ", "), " subnetwork "))
Sys.sleep(0.5)
setCurrentNetwork("gene-KE-AOP network with pathways and chemicals")
setCurrentView("gene-KE-AOP network with pathways and chemicals")
clearSelection()
}
filter_chebi(c("toxin","neurotoxin"))
filter_chebi("toxin")
filter_chebi(c("toxin","neurotoxin","genotoxin"))
filter_chebi(c("drug allergen","drug metabolite)"))
filter_chebi(c("drug allergen","drug metabolite"))
